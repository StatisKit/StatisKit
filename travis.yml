language: cpp

env:
    - RECIPE=gmp
    - RECIPE=mpfr
    - RECIPE=mpc
    - RECIPE=isl 
    - RECIPE=binutils 
    - RECIPE=glibc 
    - RECIPE=gcc 
    - RECIPE=libgcc 
    - RECIPE=clang 
    - RECIPE=cpp-build 
    - RECIPE=cpp-run
    - RECIPE=python-scons
    - RECIPE=py-build
    - RECIPE=py-run
    - RECIPE=libboost

os:
    - linux
    - osx

matrix:
    include:
        -   os: linux
            dist: trusty
            sudo: required
        -   os: osx
            osx_image: xcode7.3

install:
    -   git clone https://gist.github.com/319558c83d145620a6d4decdcadfbfb0.git config-travis
    -   cd config-travis
    -   source config.sh
    -   cd ..

script:
    - cd conda
    - conda build $RECIPE -c statiskit -c conda-forge

after_success:
    # -   export ANACONDA_UPLOAD_FLAGS="--force"
    -   if [[ ! "$ANACONDA_BUILD_RECIPES" = "" ]] && [[ "$TRAVIS_BRANCH" = "master" ]] && [[ "$TRAVIS_PULL_REQUEST" = "false" ]] && [[ ! -z $ANACONDA_USERNAME ]]; then
            cd conda;
            bash upload.sh;
            cd ..;
        fi
    -   if [[ "$ANACONDA_BUILD_RECIPES" = "" ]] && [[ "$TRAVIS_BRANCH" = "master" ]] && [[ "$TRAVIS_PULL_REQUEST" = "false" ]] && [[ "$TRAVIS_OS_NAME" = "linux" ]] && [[ ! -z $DOCKER_USERNAME ]]; then
            cd docker;
            bash upload.sh;
            cd ..;
        fi
